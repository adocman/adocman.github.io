---
layout: default
title: Post
permalink: /post/
---

<article class="prose bg-[#FAF7F2] prose-lg prose-gray px-6 md:px-50 mx-auto py-20 md:py-20 text-gray-800">
  <header class="mb-12 text-center">
    <p class="text-sm uppercase tracking-wide text-gray-500">
      {{ page.type | capitalize }}
    </p>
    <h1 class="text-4xl md:text-5xl font-serif font-bold text-gray-900 leading-tight mb-4">
      {{ page.title }}
    </h1>
    <time datetime="{{ page.date | date_to_xmlschema }}" class="text-gray-400 text-sm">
      {{ page.date | date: "%d de %B de %Y" }}
    </time>
  </header>

  {% if page.image %}
  <figure class="mb-12 -mt-4">
    <img src="{{ page.image }}" alt="{{ page.title }}" class="w-full rounded-xl shadow-md">
    {% if page.image_caption %}
    <figcaption class="mt-2 text-sm text-gray-500 text-center italic">
      {{ page.image_caption }}
    </figcaption>
    {% endif %}
  </figure>
  {% endif %}

  <section id="post-content" class="prose prose-gray prose-lg max-w-none">
    {{ content }}
  </section>
</article>

<div id="reading-time-btn" class="flex fixed top-24 left-4 md:left-12 z-50 cursor-pointer">
  <svg id="progress-circle" class="w-16 h-16 md:w-20 md:h-20" viewBox="0 0 100 100">
    <circle cx="50" cy="50" r="45" stroke="#FAF7F2" stroke-width="6" fill="black"/>
    <circle id="progress-bar" cx="50" cy="50" r="45" stroke="#292524" stroke-width="6" fill="transparent"
            stroke-dasharray="283" stroke-dashoffset="283"
            transform="rotate(-90 50 50)" />
    <text id="read-minutes" x="50" y="45" text-anchor="middle" fill="white" font-size="24" font-weight="bold">0</text>
    <text x="50" y="60" text-anchor="middle" fill="white" font-size="16">min</text>
    <text x="50" y="72" text-anchor="middle" fill="white" font-size="16">lectura</text>
  </svg>
</div>

<aside id="toc-panel" class="fixed top-0 left-0 h-full w-48 bg-[#FAF7F2] shadow-lg p-6 transform -translate-x-full z-50 overflow-y-auto transition-transform duration-300 ease-in-out">
  <h2 class="text-lg font-bold mb-4">Tabla de contenidos</h2>
  <ul id="toc-list" class="space-y-2"></ul>
</aside>

<script>
// Código JavaScript para el funcionamiento de los nuevos elementos
document.addEventListener("DOMContentLoaded", () => {
  const content = document.getElementById("post-content").innerText;
  const words = content.trim().split(/\s+/).length;
  const minutes = Math.max(1, Math.ceil(words / 200));
  document.getElementById("read-minutes").textContent = minutes;

  const tocList = document.getElementById("toc-list");
  document.querySelectorAll("#post-content h2, #post-content h3").forEach((heading, index) => {
    const id = "section-" + index;
    heading.id = id;

    const li = document.createElement("li");
    li.textContent = heading.textContent;
    li.className = "cursor-pointer hover:text-[#4A6C6F] transition-colors duration-200";
    li.addEventListener("click", () => {
      window.scrollTo({ top: heading.offsetTop - 100, behavior: "smooth" });
    });
    tocList.appendChild(li);
  });

  const tocPanel = document.getElementById("toc-panel");
  const readingTimeBtn = document.getElementById("reading-time-btn");

  // Función para cerrar el TOC
  function closeToc() {
    tocPanel.classList.add("-translate-x-full");
    document.removeEventListener("click", closeTocOutsideClick);
  }

  // Función para cerrar el TOC al hacer clic fuera
  function closeTocOutsideClick(event) {
    if (!tocPanel.contains(event.target) && !readingTimeBtn.contains(event.target)) {
      closeToc();
    }
  }

  // Toggle del TOC
  readingTimeBtn.addEventListener("click", () => {
    const isTocOpen = !tocPanel.classList.contains("-translate-x-full");
    if (isTocOpen) {
      closeToc();
    } else {
      tocPanel.classList.remove("-translate-x-full");
      // Cierra el TOC si se hace clic fuera del panel o del botón
      setTimeout(() => {
        document.addEventListener("click", closeTocOutsideClick);
      }, 100);
    }
  });

  // Resaltar sección actual
  window.addEventListener("scroll", () => {
    let current;
    document.querySelectorAll("#post-content h2, #post-content h3").forEach(section => {
      const sectionTop = section.offsetTop - 120;
      if (window.scrollY >= sectionTop) {
        current = section;
      }
    });

    document.querySelectorAll("#toc-list li").forEach(li => {
      li.classList.remove("text-[#4A6C6F]", "font-bold");
      if (li.textContent === current?.textContent) {
        li.classList.add("text-[#4A6C6F]", "font-bold");
      }
    });

    // Actualizar barra de progreso
    const progressBar = document.getElementById("progress-bar");
    const scrollTop = window.scrollY;
    const docHeight = document.body.scrollHeight - window.innerHeight;
    const scrollPercent = scrollTop / docHeight;
    const dashArray = 2 * Math.PI * 45;
    const dashOffset = dashArray * (1 - scrollPercent);
    progressBar.style.strokeDashoffset = dashOffset;
  });
});
</script>